# Rich Text

This module contains helper functions to convert HTML or a DOM tree into a rich text value and back, and to modify the value with functions that are similar to `String` methods, plus some additional ones for formatting.

## Installation

Install the module

```bash
npm install @wordpress/rich-text
```

_This package assumes that your code will run in an **ES2015+** environment. If you're using an environment that has limited or no support for ES2015+ such as lower versions of IE then using [core-js](https://github.com/zloirock/core-js) or [@babel/polyfill](https://babeljs.io/docs/en/next/babel-polyfill) will add support for these methods. Learn more about it in [Babel docs](https://babeljs.io/docs/en/next/caveats)._

## API

<!-- START TOKEN(Autogenerated API docs) -->

<a href="#applyformat">#</a> **applyFormat** [\<>](src/index.js#L6-L6)

Apply a format object to a Rich Text value from the given `startIndex` to the
given `endIndex`. Indices are retrieved from the selection if none are
provided.

_Parameters_

-   `Object`: Value to modify.
-   `Object`: Format to apply.
-   `[number]`: Start index.
-   `[number]`: End index.

_Returns_

-   `Object`: A new value with the format applied.

<a href="#concat">#</a> **concat** [\<>](src/index.js#L8-L8)

Combine all Rich Text values into one. This is similar to
`String.prototype.concat`.

_Parameters_

-   `...Object`: Objects to combine.

_Returns_

-   `Object`: A new value combining all given records.

<a href="#create">#</a> **create** [\<>](src/index.js#L9-L9)

Create a RichText value from an `Element` tree (DOM), an HTML string or a
plain text string, with optionally a `Range` object to set the selection. If
called without any input, an empty value will be created. If
`multilineTag` is provided, any content of direct children whose type matches
`multilineTag` will be separated by two newlines. The optional functions can
be used to filter out content.

A value will have the following shape, which you are strongly encouraged not
to modify without the use of helper functions:

```js
{
  text: string,
  formats: Array,
  replacements: Array,
  ?start: number,
  ?end: number,
}
```

As you can see, text and formatting are separated. `text` holds the text,
including any replacement characters for objects and lines. `formats`,
`objects` and `lines` are all sparse arrays of the same length as `text`. It
holds information about the formatting at the relevant text indices. Finally
`start` and `end` state which text indices are selected. They are only
provided if a `Range` was given.

_Parameters_

-   `[Object]`: Optional named arguments.
-   `[Element]`: Element to create value from.
-   `[string]`: Text to create value from.
-   `[string]`: HTML to create value from.
-   `[Range]`: Range to create value from.
-   `[string]`: Multiline tag if the structure is multiline.
-   `[Array]`: Tags where lines can be found if nesting is possible.

_Returns_

-   `Object`: A rich text value.

<a href="#getactiveformat">#</a> **getActiveFormat** [\<>](src/index.js#L10-L10)

Gets the format object by type at the start of the selection. This can be
used to get e.g. the URL of a link format at the current selection, but also
to check if a format is active at the selection. Returns undefined if there
is no format at the selection.

_Parameters_

-   `Object`: Value to inspect.
-   `string`: Format type to look for.

_Returns_

-   `(Object|undefined)`: Active format object of the specified type, or undefined.

<a href="#getactiveobject">#</a> **getActiveObject** [\<>](src/index.js#L11-L11)

Gets the active object, if there is any.

_Parameters_

-   `Object`: Value to inspect.

_Returns_

-   `?Object`: Active object, or undefined.

<a href="#gettextcontent">#</a> **getTextContent** [\<>](src/index.js#L14-L14)

Get the textual content of a Rich Text value. This is similar to
`Element.textContent`.

_Parameters_

-   `Object`: Value to use.

_Returns_

-   `string`: The text content.

<a href="#insert">#</a> **insert** [\<>](src/index.js#L22-L22)

Insert a Rich Text value, an HTML string, or a plain text string, into a
Rich Text value at the given `startIndex`. Any content between `startIndex`
and `endIndex` will be removed. Indices are retrieved from the selection if
none are provided.

_Parameters_

-   `Object`: Value to modify.
-   `(Object|string)`: Value to insert.
-   `[number]`: Start index.
-   `[number]`: End index.

_Returns_

-   `Object`: A new value with the value inserted.

<a href="#insertobject">#</a> **insertObject** [\<>](src/index.js#L25-L25)

Insert a format as an object into a Rich Text value at the given
`startIndex`. Any content between `startIndex` and `endIndex` will be
removed. Indices are retrieved from the selection if none are provided.

_Parameters_

-   `Object`: Value to modify.
-   `Object`: Format to insert as object.
-   `[number]`: Start index.
-   `[number]`: End index.

_Returns_

-   `Object`: A new value with the object inserted.

<a href="#iscollapsed">#</a> **isCollapsed** [\<>](src/index.js#L15-L15)

Check if the selection of a Rich Text value is collapsed or not. Collapsed
means that no characters are selected, but there is a caret present. If there
is no selection, `undefined` will be returned. This is similar to
`window.getSelection().isCollapsed()`.

_Parameters_

-   `Object`: The rich text value to check.

_Returns_

-   `(boolean|undefined)`: True if the selection is collapsed, false if not, undefined if there is no selection.

<a href="#isempty">#</a> **isEmpty** [\<>](src/index.js#L16-L16)

Check if a Rich Text value is Empty, meaning it contains no text or any
objects (such as images).

_Parameters_

-   `Object`: Value to use.

_Returns_

-   `boolean`: True if the value is empty, false if not.

<a href="#join">#</a> **join** [\<>](src/index.js#L17-L17)

Combine an array of Rich Text values into one, optionally separated by
`separator`, which can be a Rich Text value, HTML string, or plain text
string. This is similar to `Array.prototype.join`.

_Parameters_

-   `Array<Object>`: An array of values to join.
-   `[(string|Object)]`: Separator string or value.

_Returns_

-   `Object`: A new combined value.

<a href="#registerformattype">#</a> **registerFormatType** [\<>](src/index.js#L18-L18)

Registers a new format provided a unique name and an object defining its
behavior.

_Parameters_

-   `string`: Format name.
-   `Object`: Format settings.
-   `string`: The HTML tag this format will wrap the selection with.
-   `[string]`: A class to match the format.
-   `string`: Name of the format.
-   `Function`: Should return a component for the user to interact with the new registered format.

_Returns_

-   `(WPFormat|undefined)`: The format, if it has been successfully registered; otherwise `undefined`.

<a href="#remove">#</a> **remove** [\<>](src/index.js#L20-L20)

Remove content from a Rich Text value between the given `startIndex` and
`endIndex`. Indices are retrieved from the selection if none are provided.

_Parameters_

-   `Object`: Value to modify.
-   `[number]`: Start index.
-   `[number]`: End index.

_Returns_

-   `Object`: A new value with the content removed.

<a href="#removeformat">#</a> **removeFormat** [\<>](src/index.js#L19-L19)

Remove any format object from a Rich Text value by type from the given
`startIndex` to the given `endIndex`. Indices are retrieved from the
selection if none are provided.

_Parameters_

-   `Object`: Value to modify.
-   `string`: Format type to remove.
-   `[number]`: Start index.
-   `[number]`: End index.

_Returns_

-   `Object`: A new value with the format applied.

<a href="#replace">#</a> **replace** [\<>](src/index.js#L21-L21)

Search a Rich Text value and replace the match(es) with `replacement`. This
is similar to `String.prototype.replace`.

_Parameters_

-   `Object`: The value to modify.
-   `(RegExp|string)`: A RegExp object or literal. Can also be a string. It is treated as a verbatim string and is not interpreted as a regular expression. Only the first occurrence will be replaced.
-   `(Function|string)`: The match or matches are replaced with the specified or the value returned by the specified function.

_Returns_

-   `Object`: A new value with replacements applied.

<a href="#slice">#</a> **slice** [\<>](src/index.js#L26-L26)

Slice a Rich Text value from `startIndex` to `endIndex`. Indices are
retrieved from the selection if none are provided. This is similar to
`String.prototype.slice`.

_Parameters_

-   `Object`: Value to modify.
-   `[number]`: Start index.
-   `[number]`: End index.

_Returns_

-   `Object`: A new extracted value.

<a href="#split">#</a> **split** [\<>](src/index.js#L27-L27)

Split a Rich Text value in two at the given `startIndex` and `endIndex`, or
split at the given separator. This is similar to `String.prototype.split`.
Indices are retrieved from the selection if none are provided.

_Parameters_

-   `Object`: Value to modify.
-   `[(number|string)]`: Start index, or string at which to split.
-   `[number]`: End index.

_Returns_

-   `Array`: An array of new values.

<a href="#toggleformat">#</a> **toggleFormat** [\<>](src/index.js#L30-L30)

Toggles a format object to a Rich Text value at the current selection.

_Parameters_

-   `Object`: Value to modify.
-   `Object`: Format to apply or remove.

_Returns_

-   `Object`: A new value with the format applied or removed.

<a href="#tohtmlstring">#</a> **toHTMLString** [\<>](src/index.js#L29-L29)

Create an HTML string from a Rich Text value. If a `multilineTag` is
provided, text separated by a line separator will be wrapped in it.

_Parameters_

-   `Object`: Named argements.
-   `Object`: Rich text value.
-   `[string]`: Multiline tag.

_Returns_

-   `string`: HTML string.

<a href="#unregisterformattype">#</a> **unregisterFormatType** [\<>](src/index.js#L32-L32)

Unregisters a format.

_Parameters_

-   `string`: Format name.

_Returns_

-   `(WPFormat|undefined)`: The previous format value, if it has been successfully unregistered; otherwise `undefined`.


<!-- END TOKEN(Autogenerated API docs) -->

<br/><br/><p align="center"><img src="https://s.w.org/style/images/codeispoetry.png?1" alt="Code is Poetry." /></p>
